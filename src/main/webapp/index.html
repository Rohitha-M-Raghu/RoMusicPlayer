<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<title>Ro's Music Player</title>
</head>
<body>
	<div>LOGIN</div>
	<form id="loginForm">
		<label for="username">Username:</label>
		<input type="text" id="username" name="username" required><br>
		<label for="password">Password:</label>
        <input type="password" id="password" name="password" required><br>
        <button type="submit">Login</button>
	</form>
	
	<div id="message"></div>
	
	<script>
		$(document).ready(function () {
			// login submission 
			$('#loginForm').submit(function(event) {
				event.preventDefault(); // check this
				
				var username = $('#username').val();
				var password = $('#password').val();
				// to remove
				console.log("Username: " + username);
				console.log("Password: " + password);
				
				var action = "login";
				
				$.ajax({
					url: "api/v1/auth",
					method: "POST",
					data: JSON.stringify({ action: action, username: username, password: password }),
					contentType: 'application/json',
					success: function(response, status, xhr) {
						if(status === "nocontent" ) {
							$('#message').text('Login successful! Redirecting...');
							// need to implement
							/* // Redirect to the dashboard
							window.location.href = '/dashboard.html'; */	
						} else {
							$('#message').text('Login failed...');
						}
					},
					error: function(xhr, status, error) {
						$('#message').text('An error occurred: ' + error);
					}
				});
				
				// function to get cookie value by name
				function getCookie(name, xhr) {
					var cookies = xhr.getAllResponseHeaders().split('\n');
					for (var i = 0; i < cookies.length; i++) {
		                var cookie = cookies[i].trim();
		                if (cookie.indexOf(name + '=') === 0) {
		                    return cookie.substring(name.length + 1);
		                }
		            }
		            return null;
				}
			});	
		});
	</script>
 </body>
</html>